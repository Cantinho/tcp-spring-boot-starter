buildscript {
    repositories {
        maven {
            url 'http://78.24.28.197:8081/artifactory/plugins-release' //адрес репозитория с плагинами
            credentials {
                username = "admin" //логин
                password = "password" //пароль
            }
        }
    }
    dependencies {
        classpath "org.jfrog.buildinfo:build-info-extractor-gradle:3.0.1" //зависимость для плагина
    }
}

group 'javagrinko'
version '1.0-SNAPSHOT'

apply plugin: 'java'
apply plugin: 'maven'
apply plugin: "com.jfrog.artifactory" //плагин для публикации
apply plugin: 'maven-publish' //плагин для публикации maven артифактов

def props = new Properties()
def file = new File("version.properties")
file.withInputStream {
    stream -> props.load(stream)
}
def subver = props.getProperty("subversion" , "0") as Integer
def ver = props.getProperty("version", "0") as Integer
props.setProperty("subversion",(subver+1) as String)
props.store(file.newWriter(),null)
version= ver +"."+ subver

repositories {
    mavenCentral()
    maven {
        url  "http://dl.bintray.com/javagrinko/maven"
    }
}

dependencies {
    compile 'javagrinko:spring-tcp-controller:0.29'
    compile("org.springframework.boot:spring-boot-starter:1.2.6.RELEASE");
    //compile 'com.esotericsoftware:kryonet:2.22.0-RC1'
    testCompile group: 'junit', name: 'junit', version: '4.11'
}


artifactory {
    contextUrl = "http://78.24.28.197:8081/artifactory"
    publish {
        repository {
            repoKey = 'vympel'
            username = "admin"
            password = "password"
            maven = true

        }
        defaults {
            publications ('mavenJava')
        }
    }
}

/**
 * Нужная вещь, хз зачем
 */
publishing {
    publications {
        mavenJava(MavenPublication) {
            from components.java
        }
    }
}